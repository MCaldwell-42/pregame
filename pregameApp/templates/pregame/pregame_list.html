{% extends 'shared/base.html' %}
{% load staticfiles %}

{% block css %}
    <link rel="stylesheet" href="{% static 'styles/base.css' %}" />
{% endblock %}

{% block content %}
<h1>Pregames for {{pregames.0.event_name}}</h1>
<a href="{% url 'pregameApp:pregame_form' event_id %}">No pregames or wanting to have your own? Add it!</a>
 <div id="map" class="pregame_map_page"></div>

<ol>
{% for pregame in pregames %}
    <li>
        <a class="pregame_name" href="{% url 'pregameApp:pregame_details' pregame.id %}"><h1>{{ pregame.name }}</h1></a>
        <h3>Date: {{pregame.date}} @  {{pregame.time}}</h3>
        <h4>{{pregame.description}}</h4>
    </li>
{% endfor %}
</ol>


    <script>
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: {{pregames.0.event_lat}}, lng: {{pregames.0.event_long}}},
          zoom: 12
        });
        marker = new google.maps.Marker({
        position: {lat: {{pregames.0.event_lat}}, lng: {{pregames.0.event_long}}},
        map: map,
        title: '{{pregames.0.event_name}}',
        icon: { url: "http://maps.google.com/mapfiles/ms/icons/red-dot.png"}
      })
        {% for pregame in pregames %}
          marker = new google.maps.Marker({
          position: {lat: {{pregame.latitude}}, lng: {{pregame.longitude}}},
          map: map,
          title: '{{pregame.name}}',
          icon: { url: "http://maps.google.com/mapfiles/ms/icons/blue-dot.png"}
        })
        {% endfor %}
      }
    </script>


    <script src='https://maps.googleapis.com/maps/api/js?key={{Mapkey}}&callback=initMap'
    async defer></script>

{% endblock content %}